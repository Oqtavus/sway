#!/bin/bash

step () {
    echo -e "\e[1;35m==> $1\e[0m"
}

#-------------------------------------------------------------------------------
step 'Timezone'
#-------------------------------------------------------------------------------

ln -sf /usr/share/zoneinfo/Europe/Kiev /etc/localtime

#-------------------------------------------------------------------------------
step 'Clock'
#-------------------------------------------------------------------------------

hwclock --systohc --localtime

#-------------------------------------------------------------------------------
step 'Locale'
#-------------------------------------------------------------------------------

sed -i 's/#ru_RU.UTF-8/ru_RU.UTF-8/' /etc/locale.gen
locale-gen

#-------------------------------------------------------------------------------
step 'Lang'
#-------------------------------------------------------------------------------

echo 'LANG=ru_RU.UTF-8' > /etc/locale.conf

#-------------------------------------------------------------------------------
step 'Font'
#-------------------------------------------------------------------------------

echo 'FONT=UniCyr_8x16' > /etc/vconsole.conf

#-------------------------------------------------------------------------------
step 'Name'
#-------------------------------------------------------------------------------

echo 'desktop' > /etc/hostname
echo '127.0.0.1 desktop.localdomain desktop' >> /etc/hosts

#-------------------------------------------------------------------------------
step 'Initcpio'
#-------------------------------------------------------------------------------

mkinitcpio -p linux

#-------------------------------------------------------------------------------
step 'Root password'
#-------------------------------------------------------------------------------

passwd

#-------------------------------------------------------------------------------
step 'User'
#-------------------------------------------------------------------------------

useradd -m -g users -G wheel -s /bin/bash qtm

#-------------------------------------------------------------------------------
step 'User password'
#-------------------------------------------------------------------------------

passwd qtm

#-------------------------------------------------------------------------------
step 'Sudoers'
#-------------------------------------------------------------------------------

sed -i 's/# %wheel ALL=(ALL) ALL/%wheel ALL=(ALL) ALL/' /etc/sudoers

#-------------------------------------------------------------------------------
step 'Grub'
#-------------------------------------------------------------------------------

pacman -S grub os-prober polkit networkmanager
grub-install /dev/sda
grub-mkconfig -o /boot/grub/grub.cfg

#-------------------------------------------------------------------------------
step 'Network'
#-------------------------------------------------------------------------------

systemctl enable NetworkManager.service

#-------------------------------------------------------------------------------
step 'Done!'
#-------------------------------------------------------------------------------
